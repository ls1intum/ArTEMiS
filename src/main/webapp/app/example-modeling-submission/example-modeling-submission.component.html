<jhi-alert></jhi-alert>
<div class="p-4" *ngIf="exercise">
    <div class="row">
        <div class="col-lg-2">
            <button class="btn btn-secondary" (click)="back()">&larr;</button>
        </div>

        <div class="col-12 col-lg-6">
            <h2>
                <span *ngIf="isNewSubmission">Create New </span>Example Modeling Submission for Exercise {{exercise?.title}}
            </h2>
        </div>

        <div class="col-12 col-lg-4 text-right" *ngIf="isAtLeastInstructor && !readOnly && !toComplete">
            <div class="row" *ngIf="!assessmentMode">
                <div class="form-check col-6 align-baseline">
                    <input type="checkbox" name="usedForTutorial" id="field_usedForTutorial"
                           [(ngModel)]="usedForTutorial"/>
                    <label class="form-check-label" for="field_usedForTutorial">Used for tutorial</label>
                </div>

                <button (click)="upsertExampleModelingSubmission()" class="btn btn-primary col-6">
                    <fa-icon icon="save"></fa-icon>
                    <span *ngIf="isNewSubmission">Create new modeling submission</span>
                    <span *ngIf="!isNewSubmission">Update modeling submission</span>
                </button>
            </div>

            <div class="row" *ngIf="assessmentMode">
                <div class="form-check col-6 align-baseline"></div>
                <button (click)="saveExampleAssessment()" class="btn btn-primary col-6">
                    <fa-icon icon="save"></fa-icon>
                    Save example assessment
                </button>
            </div>

            <div class="row mt-3" *ngIf="exampleSubmission && !isNewSubmission">
                <div class="form-check col-6 align-baseline"></div>

                <button class="btn btn-secondary col-6" *ngIf="!assessmentMode" (click)="showAssessment()">
                    <fa-icon icon="chalkboard-teacher"></fa-icon>
                    <span>Show assessment</span>
                </button>

                <button class="btn btn-secondary col-6 mb-3" *ngIf="assessmentMode" (click)="showSubmission()">
                    <fa-icon icon="code-branch"></fa-icon>
                    <span>Show submission</span>
                </button>
            </div>
        </div>

        <div class="col-12">
            <p class="mb-3">
                <strong>Problem Statement:</strong> {{ exercise.problemStatement }}<br/>
            </p>
        </div>

        <div class="col-12">
            <jhi-modeling-editor
                *ngIf="!assessmentMode"
                [umlModel]="umlModel"
                [diagramType]="exercise.diagramType"
            ></jhi-modeling-editor>
            <div class="assessment-container" *ngIf="assessmentMode">
                <jhi-modeling-assessment
                    [model]="umlModel"
                    [feedbacks]="result?.feedbacks"
                    [diagramType]="exercise.diagramType"
                    [maxScore]="exercise.maxScore"
                    (feedbackChanged)="onFeedbackChanged($event)"
                ></jhi-modeling-assessment>
            </div>
        </div>
    </div>

    <div class="col-12 text-right" *ngIf="toComplete">
        <button class="btn btn-primary col-3" (click)="checkAssessment()"
                [disabled]="!feedbacks || !assessmentsAreValid">
            Submit Assessment
        </button>
    </div>

    <div class="col-12 text-rigth" *ngIf="readOnly">
        <button (click)="readAndUnderstood()" class="btn btn-success col-3">
            <fa-icon icon="save"></fa-icon>
            I have read and understood the example
        </button>
    </div>
</div>
