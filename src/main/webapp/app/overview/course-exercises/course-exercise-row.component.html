<div class="row align-items-center">
    <div class="col-auto d-none d-sm-block">
        <fa-icon [icon]="exerciseIcon.faIcon" placement="right"
                 ngbTooltip="{{exerciseIcon.tooltip}}"></fa-icon>
    </div>
    <div class="col-md col-6">
        <a [routerLink]="[exercise.id]" class="exercise-link">{{exercise.title}}</a>
        <span class="d-none d-sm-inline" *ngIf="exercise.isAtLeastTutor">
            <a class="text-primary" routerLink="/course/{{course.id}}/exercise/{{exercise.id}}/dashboard"
               routerLinkActive="active">
                <i class="fa fa-info-circle fa-fw"></i>
            </a>
            <a class="text-primary" routerLink="{{exerciseRouterLink}}" routerLinkActive="active"
               *ngIf="exerciseRouterLink">
                <i class="fa fa-graduation-cap fa-fw"></i>
            </a>
            <a class="text-primary" routerLink="/course/{{course.id}}/exercise/{{exercise.id}}/statistics"
               routerLinkActive="active" *ngIf="exercise.type === MODELING">
                <i class="fa fa-pie-chart fa-fw"></i></a>
        </span>

        <span class="badge badge-warning" *ngIf="!asQuizExercise(exercise).visibleToStudents" placement="right"
              ngbTooltip="Only visible to teaching assistants and instructors. Release date: {{exercise.releaseDate | date:'MMM d, y H:mm'}}">
                    Not Released</span>
        <span class="badge badge-success" [hidden]="!asQuizExercise(exercise).isActiveQuiz">Live</span>
    </div>
    <div class="col-md-auto col-6" [ngClass]="getUrgentClass(exercise.dueDate)">{{exercise.dueDate |
        date:'dd/MM/yy'}}
        <span class="d-none d-sm-inline">({{exercise.dueDate |
        amTimeAgo}})</span>
    </div>
    <div class="col-md-4 col-12" [ngSwitch]="exercise.participationStatus">
        <span class="text-muted" *ngSwitchCase="'uninitialized'">You have not started this exercise yet.</span>
        <span class="text-muted" *ngSwitchCase="'quiz-not-started'">The quiz hasn't started yet.</span>
        <span class="text-muted" *ngSwitchCase="'quiz-uninitialized'">You have not started this quiz yet.</span>
        <span class="text-muted"
              *ngSwitchCase="'quiz-not-participated'">You have not participated in this live quiz.</span>
        <span class="text-muted"
              *ngSwitchCase="'quiz-active'">You are currently participating in this quiz.</span>
        <span class="text-muted" *ngSwitchCase="'quiz-submitted'">You have already submitted. Wait for the quiz to end to see results.</span>
        <span *ngSwitchCase="'initialized'">
            <jhi-result [participation]="exercise.participations[0]"></jhi-result>
        </span>
        <span *ngSwitchCase="'inactive'">
            <jhi-result [participation]="exercise.participations[0]"></jhi-result>
        </span>
        <span *ngSwitchCase="'quiz-finished'">
            <jhi-result [participation]="exercise.participations[0]"></jhi-result>
        </span>
        <span *ngSwitchCase="'modeling-exercise'">
            <jhi-result [participation]="exercise.participations[0]"></jhi-result>
        </span>
        <span *ngSwitchCase="'text-exercise'">
            <jhi-result [participation]="exercise.participations[0]"></jhi-result>
        </span>
    </div>
    <div class="col-md-3 col-12" [ngSwitch]="exercise.participationStatus">
        <button class="btn btn-primary btn-sm btn-block" id="btn-student-action"
                *ngSwitchCase="'uninitialized'"
                (click)="startExercise(exercise)"
                [disabled]="exercise.loading">
            <span [hidden]="exercise.loading"><i class="fa fa-play-circle fa-fw"></i>&nbsp;<span
                class="d-none d-md-inline">Start exercise</span></span>
            <i class="fa fa-circle-o-notch fa-spin" [hidden]="!exercise.loading"></i>
        </button>
        <button class="btn btn-primary btn-sm btn-block"
                *ngSwitchCase="'inactive'"
                (click)="resumeExercise(exercise)"
                [disabled]="exercise.loading">
            <span [hidden]="exercise.loading"><i class="fa fa-play-circle fa-fw"></i>&nbsp;<span
                class="d-none d-md-inline">Resume exercise</span></span>
            <i [hidden]="!exercise.loading" class="fa fa-circle-o-notch fa-spin"></i>
        </button>
        <div *ngSwitchCase="'initialized'">
            <div
                *ngIf="exercise.type === PROGRAMMING && exercise.participations && exercise.participations.length > 0">
                <a routerLink="/editor/{{exercise.participations[0].id}}" routerLinkActive="active"
                   class="btn btn-primary btn-sm btn-block" id="btn-online-editor"
                   *ngIf="asProgrammingExercise(exercise).allowOnlineEditor">
                    <i class="fa fa-folder-open fa-fw"></i>&nbsp;<span
                    class="d-none d-md-inline">Open exercise</span></a>
                <ng-template #popContent>
                    <p>Clone your personal repository for this exercise:</p>
                    <pre style="max-width: 100%;" ngxClipboard [cbContent]="exercise.participations[0].repositoryUrl"
                         (cbOnSuccess)="onCopySuccess()" (cbOnError)="onCopyFailure()">{{exercise.participations[0].repositoryUrl}}</pre>
                    <p *ngIf="repositoryPassword">Your password is: <code class="password">{{repositoryPassword}}</code>
                        (hover to show)</p>
                    <button ngxClipboard [cbContent]="exercise.participations[0].repositoryUrl"
                            (cbOnSuccess)="onCopySuccess()" (cbOnError)="onCopyFailure()"
                            [class.btn-success]="wasCopied"
                            class="btn btn-primary btn-sm mr-2" type="button" style="min-width: 90px;">{{ wasCopied ?
                        "Copied URL" : "Copy URL"}}
                    </button>
                    <a class="btn btn-primary btn-sm mr-2"
                       [href]="buildSourceTreeUrl(exercise.participations[0].repositoryUrl) | safeUrl">Clone in
                        SourceTree</a>
                    <a href="http://www.sourcetreeapp.com" target="_blank">Atlassian SourceTree</a> is the free Git
                    client for Windows or Mac.
                </ng-template>
                <button placement="left"
                        [ngbPopover]="popContent"
                        [autoClose]="'outside'"
                        type="button" class="btn btn-primary btn-sm btn-block"><i
                    class="fa fa-download fa-fw"></i>&nbsp;<span
                    class="d-none d-md-inline">Clone repository</span>
                </button>
                <button class="btn btn-primary btn-sm btn-block" id="btn-build-plan"
                        *ngIf="asProgrammingExercise(exercise).publishBuildPlanUrl"
                        (click)="goToBuildPlan(exercise.participations[0])"><i
                    class="fa fa-external-link fa-fw"></i>
                    &nbsp;<span class="d-none d-md-inline">Go to build plan</span></button>
            </div>
        </div>
        <div *ngSwitchCase="'modeling-exercise'">
            <div *ngIf="exercise.participations && exercise.participations.length > 0"
                 class="btn-group flex-btn-group-container">
                <a routerLink="/modeling-editor/{{exercise.participations[0].id}}" routerLinkActive="active"
                   class="btn btn-primary btn-sm btn-block">
                    <i class="fa fa-folder-open fa-fw"></i>&nbsp;<span class="d-none d-md-inline"
                                                                       *ngIf="exercise.participations[0].initializationState === 'INITIALIZED'">Open modeling editor</span>
                    <span class="d-none d-md-inline"
                          *ngIf="exercise.participations[0].initializationState === 'FINISHED'">Show submission</span>
                </a>
            </div>
        </div>
        <div *ngSwitchCase="'text-exercise'">
            <div *ngIf="exercise.participations && exercise.participations.length > 0"
                 class="btn-group flex-btn-group-container">
                <a routerLink="/text/{{exercise.participations[0].id}}" routerLinkActive="active"
                   class="btn btn-primary btn-sm btn-block">
                    <i class="fa fa-folder-open fa-fw"></i>&nbsp;<span class="d-none d-md-inline"
                                                                       *ngIf="exercise.participations[0].initializationState === 'INITIALIZED'">Open text editor</span>
                    <span class="d-none d-md-inline"
                          *ngIf="exercise.participations[0].initializationState === 'FINISHED'">Show submission</span>
                </a>
            </div>
        </div>
        <div class="btn-group flex-btn-group-container" *ngIf="exercise.type === QUIZ">
            <button class="btn btn-warning btn-sm flex-fill"
                    *ngIf="asQuizExercise(exercise).isPracticeModeAvailable"
                    [routerLink]="['/quiz', exercise.id, 'practice']"
                    (click)="startPractice(exercise)"
                    [disabled]="exercise.loading">
                <span [hidden]="exercise.loading">
                    <i class="fa fa-repeat fa-fw"></i>
                    <span class="d-none d-md-inline">Practice</span>
                </span>
                <i class="fa fa-circle-o-notch fa-spin" [hidden]="!exercise.loading"></i>
            </button>
            <button class="btn btn-primary btn-sm flex-fill"
                    *ngSwitchCase="'quiz-not-started'"
                    (click)="startExercise(exercise)"
                    [disabled]="exercise.loading">
                <span [hidden]="exercise.loading">
                    <i class="fa fa-play-circle fa-fw"></i>
                    <span class="d-none d-md-inline">Open Quiz</span>
                </span>
                <i class="fa fa-circle-o-notch fa-spin" [hidden]="!exercise.loading"></i>
            </button>
            <button class="btn btn-primary btn-sm flex-fill"
                    *ngSwitchCase="'quiz-uninitialized'"
                    (click)="startExercise(exercise)"
                    [disabled]="exercise.loading">
                <span [hidden]="exercise.loading">
                    <i class="fa fa-play-circle fa-fw"></i>
                    <span class="d-none d-md-inline">Start Quiz</span>
                </span>
                <i class="fa fa-circle-o-notch fa-spin" [hidden]="!exercise.loading"></i>
            </button>
            <button class="btn btn-primary btn-sm flex-fill"
                    *ngSwitchCase="'quiz-active'"
                    (click)="startExercise(exercise)"
                    [disabled]="exercise.loading">
                <span [hidden]="exercise.loading">
                    <i class="fa fa-play-circle fa-fw"></i>
                    <span class="d-none d-md-inline">Resume Quiz</span>
                </span>
                <i class="fa fa-circle-o-notch fa-spin" [hidden]="!exercise.loading"></i>
            </button>
            <button class="btn btn-primary btn-sm flex-fill"
                    *ngSwitchCase="'quiz-submitted'"
                    (click)="startExercise(exercise)"
                    [disabled]="exercise.loading">
                <span [hidden]="exercise.loading">
                    <i class="fa fa-eye fa-fw"></i>
                    <span class="d-none d-md-inline">View Submission</span>
                </span>
                <i class="fa fa-circle-o-notch fa-spin" [hidden]="!exercise.loading"></i>
            </button>
            <button class="btn btn-primary btn-sm flex-fill"
                    *ngSwitchCase="'quiz-finished'"
                    (click)="startExercise(exercise)"
                    [disabled]="exercise.loading">
                <span [hidden]="exercise.loading">
                    <i class="fa fa-eye fa-fw"></i>
                    <span class="d-none d-md-inline">View Results</span>
                </span>
                <i class="fa fa-circle-o-notch fa-spin" [hidden]="!exercise.loading"></i>
            </button>
            <button type="submit"
                    class="btn btn-success btn-sm flex-fill"
                    *ngIf="exercise.isAtLeastTutor"
                    routerLink="/quiz/{{exercise.id}}/quiz-point-statistic" routerLinkActive="active">
                <span class="fa fa-signal"></span>
                <span class="d-none d-md-inline" jhiTranslate="global.menu.entities.statistic">Statistic</span>
            </button>
        </div>
    </div>
    <div class="exercise-divider"></div>
</div>
