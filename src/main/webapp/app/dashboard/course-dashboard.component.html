<div *ngIf="course">
    <h4>{{course.title}} <small>{{exercises.length}} released exercises, {{students.length}} students with results</small>
        <button *ngIf="exportReady" class="btn btn-primary btn-sm float-right" (click)="exportResults()"><i class="fa fa-download fa-fw"></i>&nbsp;Export Results as CSV</button>
    </h4>
    <jhi-alert></jhi-alert>
    <div class="table-responsive" *ngIf="exercises.length > 0">
        <table class="table table-striped">
            <thead>
            <tr jhiSort [(predicate)]="predicate" [(ascending)]="reverse" [callback]="callback">
                <th jhiSortBy="user.firstName"><span>Name</span> <span class="fa fa-sort"></span></th>
                <th jhiSortBy="user.login"><span>Login</span> <span class="fa fa-sort"></span></th>
                <th jhiSortBy="numberOfParticipatedExercises"><span>Participated in Exercises (%)</span> <span class="fa fa-sort"></span></th>
                <th jhiSortBy="numberOfSuccessfulExercises"><span>Successful Exercises (%)</span> <span class="fa fa-sort"></span></th>
                <th *ngIf="exerciseMaxPointsPerType[QUIZ] > 0" jhiSortBy="pointsPerExerciseType.quiz"><span>Quiz Points </span>(%)<span class="fa fa-sort"></span></th>
                <th *ngIf="exerciseMaxPointsPerType[PROGRAMMING] > 0" jhiSortBy="pointsPerExerciseType.programming"><span>Programming Points (%)</span> <span class="fa fa-sort"></span></th>
                <th *ngIf="exerciseMaxPointsPerType[MODELING] > 0" jhiSortBy="pointsPerExerciseType.modeling"><span>Modeling Points (%)</span> <span class="fa fa-sort"></span></th>
                <th jhiSortBy="overallPoints"><span>Overall Points (%)</span> <span class="fa fa-sort"></span></th>
            </tr>
            <tr>
                <th>Max</th>
                <th></th>
                <th>{{ exercises.length }}</th>
                <th>{{ exercises.length }}</th>
                <th *ngIf="exerciseMaxPointsPerType[QUIZ] > 0">{{ exerciseMaxPointsPerType[QUIZ] }}</th>
                <th *ngIf="exerciseMaxPointsPerType[PROGRAMMING] > 0">{{ exerciseMaxPointsPerType[PROGRAMMING] }}</th>
                <th *ngIf="exerciseMaxPointsPerType[MODELING] > 0">{{ exerciseMaxPointsPerType[MODELING] }}</th>
                <th>{{ overallMaxPoints }}</th>
            </tr>
            <tr>
                <th>Average</th>
                <th></th>
                <th>{{ averageNumberOfParticipatedExercises | number: '1.0-1' }} ({{ averageNumberOfParticipatedExercises / exercises.length * 100 | number: '1.0-1'  }}%)</th>
                <th>{{ averageNumberOfSuccessfulExercises | number: '1.0-1' }} ({{ averageNumberOfSuccessfulExercises / exercises.length * 100 | number: '1.0-1'  }}%)</th>
                <th *ngIf="exerciseMaxPointsPerType[QUIZ] > 0">{{ averageNumberOfPointsPerExerciseTypes[QUIZ] | number: '1.0-1' }} ({{ (averageNumberOfPointsPerExerciseTypes[QUIZ] / exerciseMaxPointsPerType[QUIZ]) * 100 | number: '1.0-1'}}%)</th>
                <th *ngIf="exerciseMaxPointsPerType[PROGRAMMING] > 0">{{ averageNumberOfPointsPerExerciseTypes[PROGRAMMING] | number: '1.0-1' }} ({{ (averageNumberOfPointsPerExerciseTypes[PROGRAMMING] / exerciseMaxPointsPerType[PROGRAMMING]) * 100 | number: '1.0-1'}}%)</th>
                <th *ngIf="exerciseMaxPointsPerType[MODELING] > 0">{{ averageNumberOfPointsPerExerciseTypes[MODELING] | number: '1.0-1' }} ({{ (averageNumberOfPointsPerExerciseTypes[MODELING] / exerciseMaxPointsPerType[MODELING]) * 100 | number: '1.0-1'}}%)</th>
                <th>{{ averageNumberOfOverallPoints | number: '1.0-1' }} ({{ averageNumberOfOverallPoints / overallMaxPoints * 100 | number: '1.0-1'}}%)</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let student of students | sortBy: predicate: reverse;">
                <td>{{ student.user.firstName }} {{ student.user.lastName }}</td>
                <td>{{ student.user.login }}</td>
                <td>{{ student.numberOfParticipatedExercises }} ({{ (student.numberOfParticipatedExercises / exercises.length) * 100 | number: '1.0-1'}}%)</td>
                <td>{{ student.numberOfSuccessfulExercises }} ({{ (student.numberOfSuccessfulExercises / exercises.length) * 100 | number: '1.0-1'}}%)</td>
                <td *ngIf="exerciseMaxPointsPerType[QUIZ] > 0">{{ student.pointsPerExerciseType[QUIZ] | number: '1.0-1'}} ({{ (student.pointsPerExerciseType[QUIZ] / exerciseMaxPointsPerType[QUIZ]) * 100 | number: '1.0-1'}}%)</td>
                <td *ngIf="exerciseMaxPointsPerType[PROGRAMMING] > 0">{{ student.pointsPerExerciseType[PROGRAMMING] | number: '1.0-1'}} ({{ (student.pointsPerExerciseType[PROGRAMMING] / exerciseMaxPointsPerType[PROGRAMMING]) * 100 | number: '1.0-1'}}%)</td>
                <td *ngIf="exerciseMaxPointsPerType[MODELING] > 0">{{ student.pointsPerExerciseType[MODELING] | number: '1.0-1'}} ({{ (student.pointsPerExerciseType[MODELING] / exerciseMaxPointsPerType[MODELING]) * 100 | number: '1.0-1'}}%)</td>
                <td>{{ student.overallPoints | number: '1.0-1'}} ({{ student.overallPoints / overallMaxPoints * 100 | number: '1.0-1'}}%)</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
